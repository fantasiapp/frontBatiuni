{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { EventEmitter } from \"@angular/core\";\nimport { Clear, QueryAll } from \"src/models/new/data.state\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngxs/store\";\nimport * as i2 from \"@angular/common\";\n\nfunction UISuggestionBox_ng_container_0_ul_1_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\", 2);\n    i0.ɵɵlistener(\"click\", function UISuggestionBox_ng_container_0_ul_1_li_1_Template_li_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const suggestion_r4 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(3);\n      return ctx_r6.choose(suggestion_r4);\n    });\n    i0.ɵɵelementStart(1, \"b\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \", \");\n    i0.ɵɵelementStart(4, \"em\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const suggestion_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(suggestion_r4.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(suggestion_r4.address);\n  }\n}\n\nfunction UISuggestionBox_ng_container_0_ul_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\");\n    i0.ɵɵtemplate(1, UISuggestionBox_ng_container_0_ul_1_li_1_Template, 6, 2, \"li\", 1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const suggestions_r1 = i0.ɵɵnextContext().ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", suggestions_r1);\n  }\n}\n\nfunction UISuggestionBox_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, UISuggestionBox_ng_container_0_ul_1_Template, 2, 1, \"ul\", 0);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const suggestions_r1 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.showSuggestions && suggestions_r1.length);\n  }\n}\n\nexport class UISuggestionBox {\n  constructor(store, cd) {\n    this.store = store;\n    this.cd = cd;\n    this.query = '';\n    this.showSuggestions = false;\n    this.choice = new EventEmitter();\n    this.picked = false;\n    this.suggestions$.subscribe(console.log);\n  }\n\n  get nonFocusable() {\n    return -1;\n  }\n\n  set setQuery(query) {\n    if (!query) return;\n    this.picked = false;\n    this.query = query;\n    this.store.dispatch(new this.action(query)).subscribe(() => {\n      if (!this.picked && !this.showSuggestions) {\n        this.showSuggestions = true;\n        this.cd.markForCheck();\n      }\n    });\n  }\n\n  choose(suggestion) {\n    this.showSuggestions = false;\n    this.picked = true;\n    this.choice.emit(suggestion);\n    this.store.dispatch(new Clear('Establishments'));\n  }\n\n  hideSuggestions() {\n    this.showSuggestions = false;\n    this.cd.markForCheck();\n  }\n\n  cancel() {\n    this.hideSuggestions();\n    this.picked = false;\n  }\n\n}\n\nUISuggestionBox.ɵfac = function UISuggestionBox_Factory(t) {\n  return new (t || UISuggestionBox)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n};\n\nUISuggestionBox.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UISuggestionBox,\n  selectors: [[\"suggestion-box\"]],\n  hostVars: 1,\n  hostBindings: function UISuggestionBox_HostBindings(rf, ctx) {\n    if (rf & 2) {\n      i0.ɵɵattribute(\"tabindex\", ctx.nonFocusable);\n    }\n  },\n  inputs: {\n    setQuery: [\"query\", \"setQuery\"],\n    action: \"action\"\n  },\n  outputs: {\n    choice: \"choice\"\n  },\n  decls: 2,\n  vars: 3,\n  consts: [[4, \"ngIf\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"click\"]],\n  template: function UISuggestionBox_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, UISuggestionBox_ng_container_0_Template, 2, 1, \"ng-container\", 0);\n      i0.ɵɵpipe(1, \"async\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 1, ctx.suggestions$));\n    }\n  },\n  directives: [i2.NgIf, i2.NgForOf],\n  pipes: [i2.AsyncPipe],\n  styles: [\"[_ngcontent-%COMP%]:root{--notification-size: $notification-size}[_nghost-%COMP%]{width:100%;position:absolute;z-index:10;max-height:300px;overflow:hidden auto;background:white}ul[_ngcontent-%COMP%]{margin:3px;padding:20px 0;box-shadow:0 4px 6px #ccc}li[_ngcontent-%COMP%]{padding:5px 20px}li[_ngcontent-%COMP%]:hover{background:#0D6191;color:#fff}\"],\n  changeDetection: 0\n});\n\n__decorate([QueryAll('Establishments')], UISuggestionBox.prototype, \"suggestions$\", void 0);\n\n;","map":null,"metadata":{},"sourceType":"module"}