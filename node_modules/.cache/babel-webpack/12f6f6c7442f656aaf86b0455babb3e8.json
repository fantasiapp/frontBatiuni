{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { take } from \"rxjs/operators\";\nimport { DataQueries, QueryProfile } from \"src/models/new/data.state\";\nimport { Destroy$ } from \"../../common/classes\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngxs/store\";\nimport * as i2 from \"../../services/image-generator.service\";\nimport * as i3 from \"../../services/file-downloader.service\";\nimport * as i4 from \"@angular/common\";\n\nfunction UIProfileImageComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵelement(1, \"div\", 4);\n    i0.ɵɵelement(2, \"div\", 5);\n    i0.ɵɵelement(3, \"div\", 6);\n    i0.ɵɵelement(4, \"div\", 7);\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport class UIProfileImageComponent extends Destroy$ {\n  constructor(cd, store, imageGenerator, downloader) {\n    super();\n    this.cd = cd;\n    this.store = store;\n    this.imageGenerator = imageGenerator;\n    this.downloader = downloader;\n    this.image = null;\n    this.src = '';\n    this.borders = true;\n  }\n\n  ngOnChanges(changes) {\n    if (changes['profile']) {\n      this.profile.pipe(take(1)).subscribe(profile => {\n        this.image = this.store.selectSnapshot(DataQueries.getProfileImage(profile.company.id));\n\n        if (!this.image) {\n          const fullname = profile.company.name[0].toUpperCase();\n          this.src = this.imageGenerator.generate(fullname);\n          this.cd.markForCheck();\n        } else {\n          this.downloader.downloadFile(this.image).subscribe(image => {\n            this.src = this.downloader.toSecureBase64(image);\n            this.cd.markForCheck();\n          });\n        }\n      });\n    }\n  }\n\n}\n\nUIProfileImageComponent.ɵfac = function UIProfileImageComponent_Factory(t) {\n  return new (t || UIProfileImageComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.ImageGenerator), i0.ɵɵdirectiveInject(i3.FileDownloader));\n};\n\nUIProfileImageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UIProfileImageComponent,\n  selectors: [[\"profile-image\"]],\n  hostVars: 2,\n  hostBindings: function UIProfileImageComponent_HostBindings(rf, ctx) {\n    if (rf & 2) {\n      i0.ɵɵclassProp(\"borders\", ctx.borders);\n    }\n  },\n  inputs: {\n    profile: \"profile\",\n    borders: \"borders\"\n  },\n  features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature],\n  decls: 3,\n  vars: 2,\n  consts: [[1, \"image-container\"], [3, \"src\"], [\"class\", \"ticks position-absolute\", 4, \"ngIf\"], [1, \"ticks\", \"position-absolute\"], [1, \"position-absolute\", \"absolute-center-x\", \"top\"], [1, \"position-absolute\", \"absolute-center-y\", \"left\"], [1, \"position-absolute\", \"absolute-center-y\", \"right\"], [1, \"position-absolute\", \"absolute-center-x\", \"bottom\"]],\n  template: function UIProfileImageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelement(1, \"img\", 1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(2, UIProfileImageComponent_div_2_Template, 5, 0, \"div\", 2);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"src\", ctx.src || \"assets/profile.png\", i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.borders);\n    }\n  },\n  directives: [i4.NgIf],\n  styles: [\"[_ngcontent-%COMP%]:root{--notification-size: $notification-size}.borders[_nghost-%COMP%]{border-color:#aaa}[_nghost-%COMP%]{display:block;position:relative;flex-shrink:0;width:134px;height:134px;border-radius:50%;transform:rotate(45deg);border:8px solid transparent}[_nghost-%COMP%], [_nghost-%COMP%]   .image-container[_ngcontent-%COMP%], [_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%}[_nghost-%COMP%]   .image-container[_ngcontent-%COMP%]{overflow:hidden;top:0;left:0;position:absolute}[_nghost-%COMP%]   .image-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:118px;height:118px;object-fit:cover}[_nghost-%COMP%] > *[_ngcontent-%COMP%]{transform:rotate(-45deg)}.ticks[_ngcontent-%COMP%]{width:134px;height:134px;top:-8px;left:-8px}.ticks[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%], .ticks[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{height:10px;width:3px}.ticks[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .ticks[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:10px;height:3px}.ticks[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{top:100%;transform:translateY(-100%)}.ticks[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{left:100%;transform:translate(-100%)}.ticks[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#fff}\"],\n  changeDetection: 0\n});\n\n__decorate([QueryProfile()], UIProfileImageComponent.prototype, \"profile\", void 0);\n\n;","map":null,"metadata":{},"sourceType":"module"}