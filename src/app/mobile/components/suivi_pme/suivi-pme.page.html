<div class="container hosted-page space-children-margin">
  <annonce-resume [collapsed]="true" [application]="false" [post]="mission"></annonce-resume>

  <!-- CONTRAT DOCUSIGN URL -->
  <div *ngIf="isNotSigned" class="contrat">
    <h6 class="title font-Poppins" style="margin-bottom: 20px;">
      Le contrat
    </h6> 
    <div class="flex center-cross space-around" (click)="signContract()">
      <file-svg name="Contrat" color="red"></file-svg>
      <h6 *ngIf="isNotSignedByUser" class="contrat-title font-Poppins">
        Signer le contrat
      </h6> 
  </div>
</div>
<!-- ENDBLOCK CONTRAT -->
<!-- <div class="suivi-notification flex center-cross">
  <h6 class="font-Poppins">
    Suivi du chantier
  </h6> -->
</div>
<div class="suivi-notification flex column" style="margin-left:0">
  <h6 class="font-Poppins" style="margin:5px">Suivi du chantier</h6>
  <h6 class="font-Poppins" style="margin:5px">Avec {{subContractorName}} entreprise {{ companyName }} </h6>
</div>
<div *ngIf="update" class="full-width flex column">
  <ng-container *ngFor="let date of dates">
    <accordion [title]="'Le ' + date.value">
      <div class="form-input">
        <div class="clear-margin full-width flex center-cross space-arround">
          <label style="color:#0C5E8D; padding-left:3%">Choisir les tâches pour ce jour</label>
          <div style="width:45%"></div>
          <img (click)="swipemenuModifyAction(date.id)" src="assets/Option.svg"/>
        </div>
        <div style="height:20px"></div>

        <div *ngFor="let task of date.selectedTasks" style="width:97%">
          <div class="details flex center-cross space-between">
            <span class="detail-name" style="padding-left:3%"> {{ task.content }}</span>
            <span class="controls">
              <img (click)="validate(task)" id="control_validate_{{task.id}}" [src]= "task.validationImage"/>
              <img (click)="refuse(task)" id="control_refuse_{{task.id}}" [src]= "task.invalidationImage"/>
            </span>
          </div>

          <div *ngIf="task.refused" class="divComment">
            <input id="input_{{task.id}}" class="inputComment" type="text" placeholder="Ajouter un commentaire" (focusout)="mainComment(task)">
            <img src="assets/camera.png"/>
          </div>
        
          <div class="form-input">
            <label style="color:#0C5E8D; padding-left:3%">Communiquer avec votre partenaire de chantier</label>
            <!-- <textarea class="form-element" formControlName="description" placeholder="..."></textarea> -->
            <div class="divComment">
              <input id="input_general}" class="inputComment" type="text" placeholder="Ajouter un commentaire" (focusout)="mainComment(null)">
              <img src="assets/camera.png"/>
            </div>
          </div>

          <div *ngIf = "date.isSelected">
            <ul id="suiviListTasks" style="width:90%; margin-left:5%">
              <li class="suiviListElement" *ngFor="let task of date.tasks" class="flex center-cross space-between" style="padding-bottom:10px">
                {{ task.content }}
                <checkbox (click)="modifyDetailedPostDate(task, date)" [value]="task.date == date.value"></checkbox>
              </li>
            </ul> 
          </div>
        </div>
      </div>

    </accordion>
    <hr class="dashed">
  </ng-container>
  <div class="newDate">
    <p>Ajouter une nouvelle date</p>
  </div>
</div>

<swipeup [(open)]="swipemenu">
  <li>Modifier les horaires de présence</li>
  <li>Appeler le 06 21 94 03 86</li>
  <li>Clôturer la mission</li>
  <li>Dupliquer l'annonce</li>
</swipeup>

<swipeup [(open)]="swipemenuModify">
  <li (click)="addDateToPost()"> Modifier les tâche</li>
</swipeup>

<ng-template #comment>
  <comment [edit]="true"></comment>
</ng-template>