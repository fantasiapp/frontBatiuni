<div class="container hosted-page space-children-margin">
  <annonce-resume [collapsed]="true" [application]="false" [post]="mission"></annonce-resume>

  <!-- CONTRAT DOCUSIGN URL -->
  <div *ngIf="isNotSigned" class="contrat">
    <h3>
      Le contrat
    </h3> 
    <div class="flex center-cross space-around" (click)="signContract()">
      <file-svg name="Contrat" color="red"></file-svg>
      <h4 *ngIf="isNotSignedByUser" class="contrat-title font-Poppins">
        Signer le contrat
      </h4> 
  </div>
</div>
<!-- ENDBLOCK CONTRAT -->
<!-- <div class="suivi-notification flex center-cross">
  <h6 class="font-Poppins">
    Suivi du chantier
  </h6> -->
</div>
<div class="suivi-notification">
  <h4 class="font-Poppins">Suivi du chantier</h4>
  <p class="font-Roboto">Avec {{contactName}} entreprise {{ companyName }} </p>
</div>
<div class="full-width flex column">
  <suivi-chantier_date *ngFor="let date of dates" [date]="date" [mission]="mission" [reloadMission]="reloadMission"></suivi-chantier_date>
  <!-- <div class="newDate">
    <img src="assets/plusBlue.svg">
    <span>Ajouter une nouvelle date</span>
  </div> -->
  <div style="height:30px"></div>
</div>

<swipeup [(open)]="missionMenu.swipeup">
  <li>Modifier les horaires de présence</li>
  <li>Appeler le 06 21 94 03 86</li>
  <li (click)="closeMission()">Clôturer la mission</li>
  <li>Dupliquer l'annonce</li>
</swipeup>

<swipeup [(open)]="missionMenu.swipeupCloseMission">
  <div class="cloture-swipeup">
    <h3>Noter l'entreprise</h3>
    <h6 *ngIf="mission">{{ mission!.subContractorName }}</h6>
    <div class="star-container" *ngIf="hasGeneralStars">
      <img  *ngFor="let flag of getArrayStar('general'); let index=index;" [src]="flag ? 'assets/starFull.svg' : 'assets/starEmpty.svg'">
    </div>

    <div *ngIf="mission" class="form-input">
      <p>Qualité du travail fourni</p>
      <div class="star-container">
        <img *ngFor="let flag of getArrayStar('quality'); let index=index;" (click)="starAction(index, 'quality')" [src]="flag ? 'assets/starFull.svg' : 'assets/starEmpty.svg'">
      </div>
      <textarea (focusout)="textStarAction('quality')" placeholder="Ajouter un commentaire" rows="5" cols="30" id="starTextQuality">{{ mission!.qualityComment }}</textarea>
    </div>
    
    <div *ngIf="mission" class="form-input">
      <p>Respect de la sécurité et de la propreté du chantier</p>
      <div class="star-container">
        <img *ngFor="let flag of getArrayStar('security'); let index=index;" (click)="starAction(index, 'security')" [src]="flag ? 'assets/starFull.svg' : 'assets/starEmpty.svg'">
      </div>
      <textarea (click)="textStarAction('security')" placeholder="Ajouter un commentaire" rows="5" cols="30" id="starTextSecurity">{{ mission!.securityComment }}</textarea>
    </div>

    <div *ngIf="mission" class="form-input">
      <p>Organisation</p>
      <div class="star-container">
        <img *ngFor="let flag of getArrayStar('organisation'); let index=index;" (click)="starAction(index, 'organisation')" [src]="flag ? 'assets/starFull.svg' : 'assets/starEmpty.svg'">
      </div>
      <textarea (click)="textStarAction('organisation')" placeholder="Ajouter un commentaire" rows="5" cols="30" id="starTextOrganisation">{{ mission!.organisationComment }}</textarea>
    </div>
    <button [ngClass]="classSubmit" (click)="submitStar()">Valider</button>
  </div>
</swipeup>

<ng-template #comment>
  <comment [edit]="true"></comment>
</ng-template>